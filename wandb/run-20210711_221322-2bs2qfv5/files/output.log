Generator is created!
Initialize generator with xavier type
Discriminator is created!
Initialize discriminator with xavier type
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
The overall number of images equals to 7752
[Epoch 1/40] [Batch 0/1938] [first Mask L1 Loss: 0.00105] [second Mask L1 Loss: 0.00123]
[D Loss: -0.00886] [G Loss: 0.65281] time_left: 11 days, 18:40:47.371502
[Epoch 1/40] [Batch 1/1938] [first Mask L1 Loss: 0.00493] [second Mask L1 Loss: 0.00358]
[D Loss: 0.01322] [G Loss: 0.53568] time_left: 1 day, 1:24:57.412798
[Epoch 1/40] [Batch 2/1938] [first Mask L1 Loss: 0.00188] [second Mask L1 Loss: 0.00502]
[D Loss: -0.00476] [G Loss: 0.63603] time_left: 23:58:51.475668
[Epoch 1/40] [Batch 3/1938] [first Mask L1 Loss: 0.00540] [second Mask L1 Loss: 0.00117]
[D Loss: -0.00201] [G Loss: 0.71121] time_left: 23:15:21.532903
[Epoch 1/40] [Batch 4/1938] [first Mask L1 Loss: 0.00454] [second Mask L1 Loss: 0.00147]
[D Loss: 0.00279] [G Loss: 0.58248] time_left: 23:40:28.301460
[Epoch 1/40] [Batch 5/1938] [first Mask L1 Loss: 0.00290] [second Mask L1 Loss: 0.00671]
[D Loss: -0.00274] [G Loss: 0.70176] time_left: 1 day, 0:00:39.427260
[Epoch 1/40] [Batch 6/1938] [first Mask L1 Loss: 0.00110] [second Mask L1 Loss: 0.00206]
[D Loss: 0.00490] [G Loss: 0.61293] time_left: 23:47:17.669394
[Epoch 1/40] [Batch 7/1938] [first Mask L1 Loss: 0.00068] [second Mask L1 Loss: 0.00306]
[D Loss: -0.00312] [G Loss: 0.64206] time_left: 23:48:12.394301
[Epoch 1/40] [Batch 8/1938] [first Mask L1 Loss: 0.00202] [second Mask L1 Loss: 0.00245]
[D Loss: -0.00405] [G Loss: 0.57826] time_left: 23:12:11.089445
[Epoch 1/40] [Batch 9/1938] [first Mask L1 Loss: 0.00055] [second Mask L1 Loss: 0.00181]
[D Loss: -0.00194] [G Loss: 0.76062] time_left: 22:25:42.146525
Traceback (most recent call last):
  File "train.py", line 78, in <module>
    trainer.WGAN_trainer(opt)
  File "/workspace/jaejun/inpainting/code/trainer.py", line 186, in WGAN_trainer
    utils.save_samples(sample_folder = sample_folder, sample_name = 'epoch%d' % (epoch + 1), img_list = img_list, name_list = name_list)
  File "/workspace/jaejun/inpainting/code/utils.py", line 141, in save_samples
    save_spectrogram(mask, sample_folder, save_img_name)
  File "/workspace/jaejun/inpainting/code/utils.py", line 185, in save_spectrogram
    im = axs.imshow(librosa.amplitude_to_db(spec), origin='lower', aspect=aspect)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/__init__.py", line 1565, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/cbook/deprecation.py", line 358, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/cbook/deprecation.py", line 358, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/axes/_axes.py", line 5615, in imshow
    im.set_data(X)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/image.py", line 699, in set_data
    .format(self._A.shape))
TypeError: Invalid shape (4, 3, 513, 431) for image data
[Epoch 1/40] [Batch 10/1938] [first Mask L1 Loss: 0.00085] [second Mask L1 Loss: 0.00026]
[D Loss: 0.00159] [G Loss: 0.58305] time_left: 23:16:33.454340
The trained model is successfully saved at epoch 1