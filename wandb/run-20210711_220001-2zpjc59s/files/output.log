Generator is created!
Initialize generator with xavier type
Discriminator is created!
Initialize discriminator with xavier type
The overall number of images equals to 7752
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
[Epoch 1/40] [Batch 0/1938] [first Mask L1 Loss: 0.00080] [second Mask L1 Loss: 0.00145]
[D Loss: -0.00180] [G Loss: -0.11116] time_left: 12 days, 0:21:12.651272
[Epoch 1/40] [Batch 1/1938] [first Mask L1 Loss: 0.00328] [second Mask L1 Loss: 0.00608]
[D Loss: -0.01079] [G Loss: -0.15448] time_left: 1 day, 7:39:35.498703
[Epoch 1/40] [Batch 2/1938] [first Mask L1 Loss: 0.00282] [second Mask L1 Loss: 0.00399]
[D Loss: -0.01161] [G Loss: -0.14750] time_left: 23:19:52.926747
[Epoch 1/40] [Batch 3/1938] [first Mask L1 Loss: 0.00261] [second Mask L1 Loss: 0.00157]
[D Loss: -0.00310] [G Loss: -0.13264] time_left: 23:18:19.306384
[Epoch 1/40] [Batch 4/1938] [first Mask L1 Loss: 0.00578] [second Mask L1 Loss: 0.00510]
[D Loss: -0.00939] [G Loss: -0.23393] time_left: 1 day, 0:17:57.285330
[Epoch 1/40] [Batch 5/1938] [first Mask L1 Loss: 0.00506] [second Mask L1 Loss: 0.00431]
[D Loss: 0.00981] [G Loss: -0.25388] time_left: 23:39:15.421700
[Epoch 1/40] [Batch 6/1938] [first Mask L1 Loss: 0.00194] [second Mask L1 Loss: 0.00229]
[D Loss: 0.00245] [G Loss: -0.15524] time_left: 23:20:38.804908
[Epoch 1/40] [Batch 7/1938] [first Mask L1 Loss: 0.00282] [second Mask L1 Loss: 0.00156]
[D Loss: -0.00232] [G Loss: -0.29772] time_left: 1 day, 0:00:31.745238
[Epoch 1/40] [Batch 8/1938] [first Mask L1 Loss: 0.00110] [second Mask L1 Loss: 0.00064]
[D Loss: 0.00033] [G Loss: -0.25025] time_left: 23:33:14.846342
[Epoch 1/40] [Batch 9/1938] [first Mask L1 Loss: 0.00075] [second Mask L1 Loss: 0.00104]
[D Loss: 0.00233] [G Loss: -0.27476] time_left: 23:57:13.478612
[Epoch 1/40] [Batch 10/1938] [first Mask L1 Loss: 0.00152] [second Mask L1 Loss: 0.00237]
[D Loss: 0.00013] [G Loss: -0.31810] time_left: 23:31:08.418570
[Epoch 1/40] [Batch 11/1938] [first Mask L1 Loss: 0.00143] [second Mask L1 Loss: 0.00092]
[D Loss: -0.00100] [G Loss: -0.28746] time_left: 1 day, 0:02:32.022196
[Epoch 1/40] [Batch 12/1938] [first Mask L1 Loss: 0.00052] [second Mask L1 Loss: 0.00016]
[D Loss: 0.00044] [G Loss: -0.22531] time_left: 23:06:24.522840
[Epoch 1/40] [Batch 13/1938] [first Mask L1 Loss: 0.00033] [second Mask L1 Loss: 0.00018]
[D Loss: -0.00021] [G Loss: -0.28246] time_left: 1 day, 0:03:09.592855
[Epoch 1/40] [Batch 14/1938] [first Mask L1 Loss: 0.00036] [second Mask L1 Loss: 0.00019]
[D Loss: -0.00005] [G Loss: -0.27052] time_left: 23:39:11.761977
[Epoch 1/40] [Batch 15/1938] [first Mask L1 Loss: 0.00061] [second Mask L1 Loss: 0.00052]
[D Loss: 0.00065] [G Loss: -0.26437] time_left: 23:42:28.661871
[Epoch 1/40] [Batch 16/1938] [first Mask L1 Loss: 0.00007] [second Mask L1 Loss: 0.00014]
[D Loss: 0.00002] [G Loss: -0.20945] time_left: 1 day, 0:05:25.439041
[Epoch 1/40] [Batch 17/1938] [first Mask L1 Loss: 0.00027] [second Mask L1 Loss: 0.00040]
[D Loss: 0.00064] [G Loss: -0.28714] time_left: 23:44:41.534781
[Epoch 1/40] [Batch 18/1938] [first Mask L1 Loss: 0.00045] [second Mask L1 Loss: 0.00028]
[D Loss: -0.00007] [G Loss: -0.29182] time_left: 23:09:34.762359
[Epoch 1/40] [Batch 19/1938] [first Mask L1 Loss: 0.00021] [second Mask L1 Loss: 0.00021]
[D Loss: -0.00005] [G Loss: -0.21983] time_left: 23:20:43.354600
[Epoch 1/40] [Batch 20/1938] [first Mask L1 Loss: 0.00029] [second Mask L1 Loss: 0.00027]
[D Loss: 0.00014] [G Loss: -0.25318] time_left: 1 day, 0:16:55.308356
[Epoch 1/40] [Batch 21/1938] [first Mask L1 Loss: 0.00023] [second Mask L1 Loss: 0.00022]
[D Loss: -0.00004] [G Loss: -0.23620] time_left: 23:44:31.727659
[Epoch 1/40] [Batch 22/1938] [first Mask L1 Loss: 0.00010] [second Mask L1 Loss: 0.00012]
[D Loss: 0.00001] [G Loss: -0.27382] time_left: 1 day, 0:57:48.770205
[Epoch 1/40] [Batch 23/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00010]
[D Loss: -0.00012] [G Loss: -0.29403] time_left: 1 day, 0:13:08.984379
[Epoch 1/40] [Batch 24/1938] [first Mask L1 Loss: 0.00025] [second Mask L1 Loss: 0.00013]
[D Loss: -0.00001] [G Loss: -0.27712] time_left: 23:24:39.198475
[Epoch 1/40] [Batch 25/1938] [first Mask L1 Loss: 0.00028] [second Mask L1 Loss: 0.00033]
[D Loss: -0.00024] [G Loss: -0.26352] time_left: 23:27:47.732676
[Epoch 1/40] [Batch 26/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00013]
[D Loss: -0.00007] [G Loss: -0.27499] time_left: 1 day, 0:03:55.393631
[Epoch 1/40] [Batch 27/1938] [first Mask L1 Loss: 0.00010] [second Mask L1 Loss: 0.00012]
[D Loss: 0.00009] [G Loss: -0.32754] time_left: 1 day, 0:08:55.504638
[Epoch 1/40] [Batch 28/1938] [first Mask L1 Loss: 0.00003] [second Mask L1 Loss: 0.00009]
[D Loss: -0.00005] [G Loss: -0.22718] time_left: 1 day, 0:10:14.511173
[Epoch 1/40] [Batch 29/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00018]
[D Loss: 0.00019] [G Loss: -0.32898] time_left: 23:54:17.125541
[Epoch 1/40] [Batch 30/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00014]
[D Loss: -0.00006] [G Loss: -0.28696] time_left: 23:14:12.280927
[Epoch 1/40] [Batch 31/1938] [first Mask L1 Loss: 0.00025] [second Mask L1 Loss: 0.00021]
[D Loss: 0.00003] [G Loss: -0.24765] time_left: 23:32:16.061148
[Epoch 1/40] [Batch 32/1938] [first Mask L1 Loss: 0.00014] [second Mask L1 Loss: 0.00020]
[D Loss: 0.00014] [G Loss: -0.34354] time_left: 1 day, 0:04:17.284504
[Epoch 1/40] [Batch 33/1938] [first Mask L1 Loss: 0.00008] [second Mask L1 Loss: 0.00025]
[D Loss: 0.00003] [G Loss: -0.25933] time_left: 1 day, 0:07:45.074014
[Epoch 1/40] [Batch 34/1938] [first Mask L1 Loss: 0.00018] [second Mask L1 Loss: 0.00009]
[D Loss: -0.00001] [G Loss: -0.19454] time_left: 1 day, 0:33:49.429917
[Epoch 1/40] [Batch 35/1938] [first Mask L1 Loss: 0.00020] [second Mask L1 Loss: 0.00032]
[D Loss: 0.00010] [G Loss: -0.27808] time_left: 23:40:58.857225
[Epoch 1/40] [Batch 36/1938] [first Mask L1 Loss: 0.00013] [second Mask L1 Loss: 0.00008]
[D Loss: -0.00007] [G Loss: -0.26241] time_left: 23:27:33.544573
[Epoch 1/40] [Batch 37/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00015]
[D Loss: -0.00000] [G Loss: -0.30962] time_left: 23:48:08.822981
[Epoch 1/40] [Batch 38/1938] [first Mask L1 Loss: 0.00005] [second Mask L1 Loss: 0.00007]
[D Loss: -0.00003] [G Loss: -0.21950] time_left: 23:58:31.610715
[Epoch 1/40] [Batch 39/1938] [first Mask L1 Loss: 0.00014] [second Mask L1 Loss: 0.00029]
[D Loss: -0.00002] [G Loss: -0.33819] time_left: 23:39:18.322893
[Epoch 1/40] [Batch 40/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00017]
[D Loss: 0.00005] [G Loss: -0.20079] time_left: 1 day, 0:29:36.378765
[Epoch 1/40] [Batch 41/1938] [first Mask L1 Loss: 0.00024] [second Mask L1 Loss: 0.00023]
[D Loss: -0.00008] [G Loss: -0.34042] time_left: 1 day, 0:16:47.323196
[Epoch 1/40] [Batch 42/1938] [first Mask L1 Loss: 0.00026] [second Mask L1 Loss: 0.00010]
[D Loss: 0.00001] [G Loss: -0.26331] time_left: 1 day, 0:09:33.428477
[Epoch 1/40] [Batch 43/1938] [first Mask L1 Loss: 0.00028] [second Mask L1 Loss: 0.00019]
[D Loss: 0.00006] [G Loss: -0.32831] time_left: 23:56:46.163063
[Epoch 1/40] [Batch 44/1938] [first Mask L1 Loss: 0.00022] [second Mask L1 Loss: 0.00029]
[D Loss: 0.00025] [G Loss: -0.31602] time_left: 1 day, 0:01:56.502029
[Epoch 1/40] [Batch 45/1938] [first Mask L1 Loss: 0.00010] [second Mask L1 Loss: 0.00037]
[D Loss: -0.00020] [G Loss: -0.24885] time_left: 1 day, 0:08:46.264930
[Epoch 1/40] [Batch 46/1938] [first Mask L1 Loss: 0.00013] [second Mask L1 Loss: 0.00034]
[D Loss: -0.00004] [G Loss: -0.25052] time_left: 23:57:52.406224
[Epoch 1/40] [Batch 47/1938] [first Mask L1 Loss: 0.00009] [second Mask L1 Loss: 0.00034]
[D Loss: 0.00003] [G Loss: -0.25941] time_left: 1 day, 0:33:18.228605
[Epoch 1/40] [Batch 48/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00021]
[D Loss: 0.00001] [G Loss: -0.26065] time_left: 23:28:53.724083
[Epoch 1/40] [Batch 49/1938] [first Mask L1 Loss: 0.00013] [second Mask L1 Loss: 0.00007]
[D Loss: -0.00006] [G Loss: -0.27739] time_left: 23:17:58.203733
[Epoch 1/40] [Batch 50/1938] [first Mask L1 Loss: 0.00008] [second Mask L1 Loss: 0.00015]
[D Loss: 0.00003] [G Loss: -0.28988] time_left: 23:26:48.917542
The trained model is successfully saved at epoch 1
Traceback (most recent call last):
  File "train.py", line 78, in <module>
    trainer.WGAN_trainer(opt)
  File "/workspace/jaejun/inpainting/code/trainer.py", line 186, in WGAN_trainer
    utils.save_samples(sample_folder = sample_folder, sample_name = 'epoch%d' % (epoch + 1), img_list = img_list, name_list = name_list, pixel_max_cnt = 255)
TypeError: save_samples() got an unexpected keyword argument 'pixel_max_cnt'