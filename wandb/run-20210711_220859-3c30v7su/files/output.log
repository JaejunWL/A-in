Generator is created!
Initialize generator with xavier type
Discriminator is created!
Initialize discriminator with xavier type
The overall number of images equals to 7752
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
[Epoch 1/40] [Batch 0/1938] [first Mask L1 Loss: 0.00095] [second Mask L1 Loss: 0.00072]
[D Loss: 0.00380] [G Loss: 0.13365] time_left: 11 days, 19:22:07.998047
[Epoch 1/40] [Batch 1/1938] [first Mask L1 Loss: 0.00391] [second Mask L1 Loss: 0.00420]
[D Loss: 0.01338] [G Loss: 0.06545] time_left: 1 day, 0:26:19.998227
[Epoch 1/40] [Batch 2/1938] [first Mask L1 Loss: 0.00397] [second Mask L1 Loss: 0.00262]
[D Loss: -0.00089] [G Loss: 0.21798] time_left: 23:06:52.794383
[Epoch 1/40] [Batch 3/1938] [first Mask L1 Loss: 0.00349] [second Mask L1 Loss: 0.00148]
[D Loss: -0.00723] [G Loss: 0.10767] time_left: 23:09:21.199234
[Epoch 1/40] [Batch 4/1938] [first Mask L1 Loss: 0.00237] [second Mask L1 Loss: 0.00268]
[D Loss: 0.00710] [G Loss: -0.00492] time_left: 23:25:53.380387
[Epoch 1/40] [Batch 5/1938] [first Mask L1 Loss: 0.00510] [second Mask L1 Loss: 0.00292]
[D Loss: -0.00041] [G Loss: -0.05851] time_left: 23:24:31.271406
[Epoch 1/40] [Batch 6/1938] [first Mask L1 Loss: 0.00091] [second Mask L1 Loss: 0.00083]
[D Loss: -0.00261] [G Loss: 0.21451] time_left: 23:53:29.946181
[Epoch 1/40] [Batch 7/1938] [first Mask L1 Loss: 0.00243] [second Mask L1 Loss: 0.00098]
[D Loss: -0.00288] [G Loss: 0.15407] time_left: 23:54:05.575888
[Epoch 1/40] [Batch 8/1938] [first Mask L1 Loss: 0.00053] [second Mask L1 Loss: 0.00053]
[D Loss: -0.00071] [G Loss: -0.08880] time_left: 1 day, 0:17:25.457420
[Epoch 1/40] [Batch 9/1938] [first Mask L1 Loss: 0.00114] [second Mask L1 Loss: 0.00085]
[D Loss: -0.00097] [G Loss: 0.13590] time_left: 23:45:50.344623
[Epoch 1/40] [Batch 10/1938] [first Mask L1 Loss: 0.00074] [second Mask L1 Loss: 0.00057]
[D Loss: 0.00159] [G Loss: 0.08542] time_left: 1 day, 0:02:20.313869
[Epoch 1/40] [Batch 11/1938] [first Mask L1 Loss: 0.00065] [second Mask L1 Loss: 0.00039]
[D Loss: -0.00022] [G Loss: 0.22390] time_left: 1 day, 0:37:07.704695
[Epoch 1/40] [Batch 12/1938] [first Mask L1 Loss: 0.00022] [second Mask L1 Loss: 0.00028]
[D Loss: 0.00039] [G Loss: 0.10326] time_left: 1 day, 0:03:10.543725
[Epoch 1/40] [Batch 13/1938] [first Mask L1 Loss: 0.00010] [second Mask L1 Loss: 0.00011]
[D Loss: 0.00006] [G Loss: 0.16973] time_left: 23:21:46.961545
[Epoch 1/40] [Batch 14/1938] [first Mask L1 Loss: 0.00043] [second Mask L1 Loss: 0.00037]
[D Loss: 0.00055] [G Loss: 0.17754] time_left: 1 day, 0:15:29.182712
[Epoch 1/40] [Batch 15/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00024]
[D Loss: -0.00055] [G Loss: 0.12207] time_left: 23:48:59.022971
[Epoch 1/40] [Batch 16/1938] [first Mask L1 Loss: 0.00030] [second Mask L1 Loss: 0.00134]
[D Loss: 0.00118] [G Loss: 0.05220] time_left: 1 day, 0:24:59.278992
[Epoch 1/40] [Batch 17/1938] [first Mask L1 Loss: 0.00036] [second Mask L1 Loss: 0.00050]
[D Loss: 0.00014] [G Loss: 0.09905] time_left: 1 day, 0:33:23.707191
[Epoch 1/40] [Batch 18/1938] [first Mask L1 Loss: 0.00026] [second Mask L1 Loss: 0.00158]
[D Loss: -0.00003] [G Loss: 0.16552] time_left: 23:49:26.359119
[Epoch 1/40] [Batch 19/1938] [first Mask L1 Loss: 0.00024] [second Mask L1 Loss: 0.00024]
[D Loss: -0.00026] [G Loss: 0.15820] time_left: 23:07:33.156687
[Epoch 1/40] [Batch 20/1938] [first Mask L1 Loss: 0.00017] [second Mask L1 Loss: 0.00042]
[D Loss: 0.00044] [G Loss: 0.03968] time_left: 23:32:03.958373
[Epoch 1/40] [Batch 21/1938] [first Mask L1 Loss: 0.00020] [second Mask L1 Loss: 0.00050]
[D Loss: -0.00017] [G Loss: 0.06025] time_left: 23:46:44.320056
[Epoch 1/40] [Batch 22/1938] [first Mask L1 Loss: 0.00015] [second Mask L1 Loss: 0.00023]
[D Loss: 0.00039] [G Loss: 0.04550] time_left: 23:43:22.518698
[Epoch 1/40] [Batch 23/1938] [first Mask L1 Loss: 0.00013] [second Mask L1 Loss: 0.00028]
[D Loss: -0.00070] [G Loss: 0.17531] time_left: 23:45:14.771407
[Epoch 1/40] [Batch 24/1938] [first Mask L1 Loss: 0.00032] [second Mask L1 Loss: 0.00022]
[D Loss: 0.00038] [G Loss: 0.18115] time_left: 23:30:42.279905
[Epoch 1/40] [Batch 25/1938] [first Mask L1 Loss: 0.00029] [second Mask L1 Loss: 0.00039]
[D Loss: 0.00075] [G Loss: 0.21986] time_left: 1 day, 0:22:04.300683
[Epoch 1/40] [Batch 26/1938] [first Mask L1 Loss: 0.00025] [second Mask L1 Loss: 0.00023]
[D Loss: 0.00034] [G Loss: 0.21262] time_left: 23:11:13.353960
[Epoch 1/40] [Batch 27/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00029]
[D Loss: 0.00015] [G Loss: 0.11250] time_left: 1 day, 0:44:00.338368
[Epoch 1/40] [Batch 28/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00009]
[D Loss: 0.00001] [G Loss: 0.09851] time_left: 1 day, 0:05:38.394340
[Epoch 1/40] [Batch 29/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00008]
[D Loss: -0.00002] [G Loss: 0.17261] time_left: 23:59:42.475471
[Epoch 1/40] [Batch 30/1938] [first Mask L1 Loss: 0.00016] [second Mask L1 Loss: 0.00013]
[D Loss: 0.00000] [G Loss: 0.23464] time_left: 23:49:35.009401
[Epoch 1/40] [Batch 31/1938] [first Mask L1 Loss: 0.00018] [second Mask L1 Loss: 0.00016]
[D Loss: -0.00003] [G Loss: 0.12491] time_left: 23:23:28.457317
[Epoch 1/40] [Batch 32/1938] [first Mask L1 Loss: 0.00020] [second Mask L1 Loss: 0.00014]
[D Loss: 0.00000] [G Loss: 0.16953] time_left: 1 day, 0:16:41.588337
[Epoch 1/40] [Batch 33/1938] [first Mask L1 Loss: 0.00020] [second Mask L1 Loss: 0.00012]
[D Loss: -0.00000] [G Loss: 0.11793] time_left: 23:47:35.392676
[Epoch 1/40] [Batch 34/1938] [first Mask L1 Loss: 0.00021] [second Mask L1 Loss: 0.00025]
[D Loss: 0.00003] [G Loss: 0.17015] time_left: 23:40:29.844766
[Epoch 1/40] [Batch 35/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00012]
[D Loss: -0.00002] [G Loss: 0.09596] time_left: 1 day, 0:06:36.843318
[Epoch 1/40] [Batch 36/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00018]
[D Loss: -0.00003] [G Loss: 0.13436] time_left: 1 day, 0:44:18.391228
[Epoch 1/40] [Batch 37/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00013]
[D Loss: -0.00002] [G Loss: 0.16657] time_left: 1 day, 0:43:58.288155
[Epoch 1/40] [Batch 38/1938] [first Mask L1 Loss: 0.00016] [second Mask L1 Loss: 0.00007]
[D Loss: 0.00002] [G Loss: 0.15193] time_left: 1 day, 0:23:45.208125
[Epoch 1/40] [Batch 39/1938] [first Mask L1 Loss: 0.00016] [second Mask L1 Loss: 0.00022]
[D Loss: 0.00003] [G Loss: 0.22058] time_left: 23:53:56.229464
[Epoch 1/40] [Batch 40/1938] [first Mask L1 Loss: 0.00008] [second Mask L1 Loss: 0.00002]
[D Loss: -0.00001] [G Loss: 0.06649] time_left: 23:50:56.691513
[Epoch 1/40] [Batch 41/1938] [first Mask L1 Loss: 0.00014] [second Mask L1 Loss: 0.00007]
[D Loss: -0.00000] [G Loss: 0.15411] time_left: 23:36:38.499448
[Epoch 1/40] [Batch 42/1938] [first Mask L1 Loss: 0.00028] [second Mask L1 Loss: 0.00032]
[D Loss: -0.00006] [G Loss: 0.21819] time_left: 23:29:01.545576
[Epoch 1/40] [Batch 43/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00011]
[D Loss: -0.00001] [G Loss: 0.14223] time_left: 23:49:16.888143
[Epoch 1/40] [Batch 44/1938] [first Mask L1 Loss: 0.00011] [second Mask L1 Loss: 0.00007]
[D Loss: -0.00000] [G Loss: 0.17625] time_left: 23:15:33.737738
[Epoch 1/40] [Batch 45/1938] [first Mask L1 Loss: 0.00026] [second Mask L1 Loss: 0.00032]
[D Loss: -0.00004] [G Loss: 0.20897] time_left: 23:07:53.659176
[Epoch 1/40] [Batch 46/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00006]
[D Loss: -0.00003] [G Loss: 0.08060] time_left: 23:37:28.409440
[Epoch 1/40] [Batch 47/1938] [first Mask L1 Loss: 0.00007] [second Mask L1 Loss: 0.00018]
[D Loss: -0.00005] [G Loss: 0.19691] time_left: 1 day, 0:29:41.526803
[Epoch 1/40] [Batch 48/1938] [first Mask L1 Loss: 0.00004] [second Mask L1 Loss: 0.00006]
[D Loss: -0.00007] [G Loss: 0.20868] time_left: 1 day, 0:08:30.264954
[Epoch 1/40] [Batch 49/1938] [first Mask L1 Loss: 0.00004] [second Mask L1 Loss: 0.00009]
[D Loss: 0.00002] [G Loss: 0.08713] time_left: 23:24:32.974280
[Epoch 1/40] [Batch 50/1938] [first Mask L1 Loss: 0.00018] [second Mask L1 Loss: 0.00017]
[D Loss: 0.00002] [G Loss: 0.07386] time_left: 23:32:43.731761
The trained model is successfully saved at epoch 1
Traceback (most recent call last):
  File "train.py", line 78, in <module>
    trainer.WGAN_trainer(opt)
  File "/workspace/jaejun/inpainting/code/trainer.py", line 186, in WGAN_trainer
    utils.save_samples(sample_folder = sample_folder, sample_name = 'epoch%d' % (epoch + 1), img_list = img_list, name_list = name_list)
  File "/workspace/jaejun/inpainting/code/utils.py", line 141, in save_samples
    save_spectrogram(mask, sample_folder, save_img_name)
  File "/workspace/jaejun/inpainting/code/utils.py", line 185, in save_spectrogram
    im = axs.imshow(librosa.amplitude_to_db(spec), origin='lower', aspect=aspect)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/__init__.py", line 1565, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/cbook/deprecation.py", line 358, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/cbook/deprecation.py", line 358, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/axes/_axes.py", line 5615, in imshow
    im.set_data(X)
  File "/opt/conda/lib/python3.7/site-packages/matplotlib/image.py", line 699, in set_data
    .format(self._A.shape))
TypeError: Invalid shape (3, 513, 431) for image data