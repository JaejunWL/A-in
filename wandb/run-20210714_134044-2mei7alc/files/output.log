Generator is created!
Initialize generator with xavier type
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
Discriminator is created!
Initialize discriminator with xavier type
The overall number of images equals to 7752
[Epoch 1/200] [Batch 0/1938] [first Mask L1 Loss: 0.00090] [second Mask L1 Loss: 0.05841]
[D Loss: 0.03548] [G Loss: 0.28627] time_left: 64 days, 11:11:16.458549
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 1/200] [Batch 1/1938] [first Mask L1 Loss: 0.00370] [second Mask L1 Loss: 0.03998]
[D Loss: -0.09824] [G Loss: 0.31409] time_left: 4 days, 23:23:48.056985
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 1/200] [Batch 2/1938] [first Mask L1 Loss: 0.00261] [second Mask L1 Loss: 0.02205]
[D Loss: -0.08599] [G Loss: 0.38018] time_left: 4 days, 20:24:34.516811
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 1/200] [Batch 3/1938] [first Mask L1 Loss: 0.00692] [second Mask L1 Loss: 0.05167]
[D Loss: 0.24479] [G Loss: 0.16531] time_left: 4 days, 19:07:55.744653
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 1/200] [Batch 4/1938] [first Mask L1 Loss: 0.00036] [second Mask L1 Loss: 0.04440]
[D Loss: 0.00749] [G Loss: 0.22335] time_left: 4 days, 18:55:52.582881
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 1/200] [Batch 5/1938] [first Mask L1 Loss: 0.00186] [second Mask L1 Loss: 0.02143]
[D Loss: -0.01379] [G Loss: 0.23053] time_left: 4 days, 21:14:50.302956
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 1/200] [Batch 6/1938] [first Mask L1 Loss: 0.00135] [second Mask L1 Loss: 0.00980]
[D Loss: -0.00500] [G Loss: 0.17234] time_left: 4 days, 20:49:15.306829
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
The trained model is successfully saved at epoch 1
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[Epoch 2/200] [Batch 0/1938] [first Mask L1 Loss: 0.00028] [second Mask L1 Loss: 0.00504]
[D Loss: 0.00104] [G Loss: 0.26391] time_left: 19 days, 9:38:15.023688
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 2/200] [Batch 1/1938] [first Mask L1 Loss: 0.00029] [second Mask L1 Loss: 0.00141]
[D Loss: -0.00091] [G Loss: 0.22771] time_left: 4 days, 20:13:15.121953
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 2/200] [Batch 2/1938] [first Mask L1 Loss: 0.00033] [second Mask L1 Loss: 0.00414]
[D Loss: -0.00429] [G Loss: 0.26946] time_left: 4 days, 22:23:02.075806
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 2/200] [Batch 3/1938] [first Mask L1 Loss: 0.00088] [second Mask L1 Loss: 0.00184]
[D Loss: -0.00186] [G Loss: 0.21659] time_left: 4 days, 21:07:35.092948
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 2/200] [Batch 4/1938] [first Mask L1 Loss: 0.00066] [second Mask L1 Loss: 0.00144]
[D Loss: 0.00045] [G Loss: 0.19983] time_left: 4 days, 20:27:48.132068
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 2/200] [Batch 5/1938] [first Mask L1 Loss: 0.00005] [second Mask L1 Loss: 0.00071]
[D Loss: -0.00038] [G Loss: 0.18641] time_left: 4 days, 19:39:27.563183
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 2/200] [Batch 6/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00019]
[D Loss: -0.00001] [G Loss: 0.19166] time_left: 4 days, 21:08:09.695332
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
The trained model is successfully saved at epoch 2
[Epoch 3/200] [Batch 0/1938] [first Mask L1 Loss: 0.00002] [second Mask L1 Loss: 0.00027]
[D Loss: 0.00000] [G Loss: 0.22910] time_left: 21 days, 3:05:57.298256
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[Epoch 3/200] [Batch 1/1938] [first Mask L1 Loss: 0.00030] [second Mask L1 Loss: 0.00117]
[D Loss: -0.00139] [G Loss: 0.22386] time_left: 4 days, 18:20:17.658468
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 3/200] [Batch 2/1938] [first Mask L1 Loss: 0.00078] [second Mask L1 Loss: 0.00058]
[D Loss: -0.00028] [G Loss: 0.12337] time_left: 4 days, 18:12:03.016354
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 3/200] [Batch 3/1938] [first Mask L1 Loss: 0.00030] [second Mask L1 Loss: 0.00223]
[D Loss: 0.00223] [G Loss: 0.19691] time_left: 4 days, 18:24:48.782405
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 3/200] [Batch 4/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00066]
[D Loss: -0.00075] [G Loss: 0.19862] time_left: 4 days, 19:13:53.557463
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 3/200] [Batch 5/1938] [first Mask L1 Loss: 0.00023] [second Mask L1 Loss: 0.00294]
[D Loss: -0.00255] [G Loss: 0.27649] time_left: 4 days, 19:07:51.107711
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 3/200] [Batch 6/1938] [first Mask L1 Loss: 0.00085] [second Mask L1 Loss: 0.00288]
[D Loss: 0.00022] [G Loss: 0.20974] time_left: 4 days, 18:54:54.139040
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
The trained model is successfully saved at epoch 3
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[Epoch 4/200] [Batch 0/1938] [first Mask L1 Loss: 0.00031] [second Mask L1 Loss: 0.00081]
[D Loss: -0.00043] [G Loss: 0.15855] time_left: 20 days, 4:30:33.231010
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 4/200] [Batch 1/1938] [first Mask L1 Loss: 0.00041] [second Mask L1 Loss: 0.00059]
[D Loss: -0.00011] [G Loss: 0.23399] time_left: 4 days, 18:39:28.148067
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 4/200] [Batch 2/1938] [first Mask L1 Loss: 0.00017] [second Mask L1 Loss: 0.00086]
[D Loss: -0.00247] [G Loss: 0.22197] time_left: 4 days, 20:56:50.145445
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 4/200] [Batch 3/1938] [first Mask L1 Loss: 0.00017] [second Mask L1 Loss: 0.00052]
[D Loss: -0.00071] [G Loss: 0.23556] time_left: 4 days, 18:32:52.033194
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
[Epoch 4/200] [Batch 4/1938] [first Mask L1 Loss: 0.00022] [second Mask L1 Loss: 0.00045]
[D Loss: -0.00024] [G Loss: 0.27509] time_left: 4 days, 18:19:39.682119
torch.Size([4, 1, 512, 428]) torch.Size([4, 1, 512, 428])
Traceback (most recent call last):
  File "train.py", line 78, in <module>
    trainer.WGAN_trainer(opt)
  File "/workspace/jaejun/inpainting/code/trainer.py", line 154, in WGAN_trainer
    optimizer_g.step()
  File "/opt/conda/lib/python3.7/site-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/torch/optim/adam.py", line 118, in step
    eps=group['eps'])
  File "/opt/conda/lib/python3.7/site-packages/torch/optim/_functional.py", line 94, in adam
    denom = (exp_avg_sq.sqrt() / math.sqrt(bias_correction2)).add_(eps)
KeyboardInterrupt