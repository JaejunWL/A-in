Generator is created!
Initialize generator with xavier type
Discriminator is created!
Initialize discriminator with xavier type
The overall number of images equals to 7752
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
/opt/conda/lib/python3.7/site-packages/torchaudio/functional/functional.py:89: UserWarning: The use of pseudo complex type in spectrogram is now deprecated.Please migrate to native complex type by providing `return_complex=True`. Please refer to https://github.com/pytorch/audio/issues/1337 for more details about torchaudio's plan to migrate to native complex type.
  "The use of pseudo complex type in spectrogram is now deprecated."
[Epoch 1/40] [Batch 0/1938] [first Mask L1 Loss: 0.00077] [second Mask L1 Loss: 0.00081]
[D Loss: -0.00050] [G Loss: -0.04562] time_left: 11 days, 21:40:50.702763
[Epoch 1/40] [Batch 1/1938] [first Mask L1 Loss: 0.00402] [second Mask L1 Loss: 0.00417]
[D Loss: 0.00544] [G Loss: -0.14638] time_left: 1 day, 13:09:12.463199
[Epoch 1/40] [Batch 2/1938] [first Mask L1 Loss: 0.00241] [second Mask L1 Loss: 0.00256]
[D Loss: -0.00025] [G Loss: -0.12452] time_left: 23:19:50.856793
[Epoch 1/40] [Batch 3/1938] [first Mask L1 Loss: 0.00265] [second Mask L1 Loss: 0.00085]
[D Loss: -0.00153] [G Loss: -0.13054] time_left: 23:00:16.882302
[Epoch 1/40] [Batch 4/1938] [first Mask L1 Loss: 0.00269] [second Mask L1 Loss: 0.00199]
[D Loss: -0.00059] [G Loss: -0.10366] time_left: 23:08:43.179813
[Epoch 1/40] [Batch 5/1938] [first Mask L1 Loss: 0.00170] [second Mask L1 Loss: 0.00111]
[D Loss: -0.00059] [G Loss: -0.00968] time_left: 22:26:13.166187
[Epoch 1/40] [Batch 6/1938] [first Mask L1 Loss: 0.00241] [second Mask L1 Loss: 0.00342]
[D Loss: 0.00122] [G Loss: -0.07490] time_left: 23:16:22.846137
[Epoch 1/40] [Batch 7/1938] [first Mask L1 Loss: 0.00195] [second Mask L1 Loss: 0.00166]
[D Loss: 0.00009] [G Loss: -0.03399] time_left: 23:24:55.930828
[Epoch 1/40] [Batch 8/1938] [first Mask L1 Loss: 0.00081] [second Mask L1 Loss: 0.00105]
[D Loss: -0.00093] [G Loss: -0.11060] time_left: 23:18:56.528767
[Epoch 1/40] [Batch 9/1938] [first Mask L1 Loss: 0.00234] [second Mask L1 Loss: 0.00105]
[D Loss: -0.00045] [G Loss: -0.10471] time_left: 23:10:02.259120
[Epoch 1/40] [Batch 10/1938] [first Mask L1 Loss: 0.00078] [second Mask L1 Loss: 0.00021]
[D Loss: -0.00005] [G Loss: -0.10164] time_left: 23:28:55.142078
[Epoch 1/40] [Batch 11/1938] [first Mask L1 Loss: 0.00065] [second Mask L1 Loss: 0.00047]
[D Loss: -0.00031] [G Loss: -0.00129] time_left: 23:22:05.449325
[Epoch 1/40] [Batch 12/1938] [first Mask L1 Loss: 0.00047] [second Mask L1 Loss: 0.00018]
[D Loss: 0.00014] [G Loss: -0.14083] time_left: 23:28:48.285533
[Epoch 1/40] [Batch 13/1938] [first Mask L1 Loss: 0.00034] [second Mask L1 Loss: 0.00043]
[D Loss: -0.00002] [G Loss: -0.12649] time_left: 23:19:56.031454
[Epoch 1/40] [Batch 14/1938] [first Mask L1 Loss: 0.00108] [second Mask L1 Loss: 0.00056]
[D Loss: -0.00019] [G Loss: -0.08493] time_left: 23:12:29.274336
[Epoch 1/40] [Batch 15/1938] [first Mask L1 Loss: 0.00023] [second Mask L1 Loss: 0.00016]
[D Loss: -0.00016] [G Loss: -0.17283] time_left: 23:18:21.544765
[Epoch 1/40] [Batch 16/1938] [first Mask L1 Loss: 0.00023] [second Mask L1 Loss: 0.00007]
[D Loss: 0.00008] [G Loss: 0.04656] time_left: 23:12:39.388046
[Epoch 1/40] [Batch 17/1938] [first Mask L1 Loss: 0.00023] [second Mask L1 Loss: 0.00020]
[D Loss: 0.00008] [G Loss: -0.17585] time_left: 23:24:14.104848
[Epoch 1/40] [Batch 18/1938] [first Mask L1 Loss: 0.00030] [second Mask L1 Loss: 0.00045]
[D Loss: -0.00004] [G Loss: -0.13712] time_left: 23:08:35.577591
[Epoch 1/40] [Batch 19/1938] [first Mask L1 Loss: 0.00041] [second Mask L1 Loss: 0.00008]
[D Loss: -0.00007] [G Loss: -0.26327] time_left: 23:40:11.901453
[Epoch 1/40] [Batch 20/1938] [first Mask L1 Loss: 0.00029] [second Mask L1 Loss: 0.00004]
[D Loss: -0.00010] [G Loss: -0.04453] time_left: 23:26:43.337836
[Epoch 1/40] [Batch 21/1938] [first Mask L1 Loss: 0.00033] [second Mask L1 Loss: 0.00013]
[D Loss: -0.00012] [G Loss: -0.15253] time_left: 22:55:47.359461
[Epoch 1/40] [Batch 22/1938] [first Mask L1 Loss: 0.00007] [second Mask L1 Loss: 0.00005]
[D Loss: -0.00006] [G Loss: -0.05866] time_left: 23:46:32.240154
[Epoch 1/40] [Batch 23/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00009]
[D Loss: 0.00002] [G Loss: -0.10158] time_left: 23:38:44.801657
[Epoch 1/40] [Batch 24/1938] [first Mask L1 Loss: 0.00050] [second Mask L1 Loss: 0.00018]
[D Loss: -0.00006] [G Loss: -0.15946] time_left: 23:30:53.439703
[Epoch 1/40] [Batch 25/1938] [first Mask L1 Loss: 0.00020] [second Mask L1 Loss: 0.00011]
[D Loss: 0.00006] [G Loss: -0.26933] time_left: 22:43:35.264068
[Epoch 1/40] [Batch 26/1938] [first Mask L1 Loss: 0.00036] [second Mask L1 Loss: 0.00015]
[D Loss: -0.00017] [G Loss: 0.02617] time_left: 23:05:15.362803
[Epoch 1/40] [Batch 27/1938] [first Mask L1 Loss: 0.00020] [second Mask L1 Loss: 0.00018]
[D Loss: -0.00010] [G Loss: -0.16403] time_left: 23:29:41.229525
[Epoch 1/40] [Batch 28/1938] [first Mask L1 Loss: 0.00023] [second Mask L1 Loss: 0.00035]
[D Loss: 0.00030] [G Loss: 0.01338] time_left: 23:50:41.943026
[Epoch 1/40] [Batch 29/1938] [first Mask L1 Loss: 0.00009] [second Mask L1 Loss: 0.00016]
[D Loss: -0.00005] [G Loss: -0.24628] time_left: 22:50:58.863726
[Epoch 1/40] [Batch 30/1938] [first Mask L1 Loss: 0.00016] [second Mask L1 Loss: 0.00011]
[D Loss: -0.00002] [G Loss: -0.11317] time_left: 23:26:59.143538
[Epoch 1/40] [Batch 31/1938] [first Mask L1 Loss: 0.00010] [second Mask L1 Loss: 0.00014]
[D Loss: -0.00003] [G Loss: -0.06056] time_left: 22:57:22.291632
[Epoch 1/40] [Batch 32/1938] [first Mask L1 Loss: 0.00035] [second Mask L1 Loss: 0.00028]
[D Loss: -0.00004] [G Loss: -0.31665] time_left: 23:39:15.042599
[Epoch 1/40] [Batch 33/1938] [first Mask L1 Loss: 0.00026] [second Mask L1 Loss: 0.00024]
[D Loss: -0.00015] [G Loss: -0.01791] time_left: 23:21:22.321062
[Epoch 1/40] [Batch 34/1938] [first Mask L1 Loss: 0.00021] [second Mask L1 Loss: 0.00012]
[D Loss: 0.00004] [G Loss: 0.07079] time_left: 23:16:49.389536
[Epoch 1/40] [Batch 35/1938] [first Mask L1 Loss: 0.00018] [second Mask L1 Loss: 0.00013]
[D Loss: 0.00003] [G Loss: 0.00462] time_left: 22:57:52.996641
[Epoch 1/40] [Batch 36/1938] [first Mask L1 Loss: 0.00008] [second Mask L1 Loss: 0.00009]
[D Loss: 0.00003] [G Loss: -0.33782] time_left: 22:34:24.165553
[Epoch 1/40] [Batch 37/1938] [first Mask L1 Loss: 0.00007] [second Mask L1 Loss: 0.00008]
[D Loss: -0.00003] [G Loss: -0.19237] time_left: 23:21:21.656806
[Epoch 1/40] [Batch 38/1938] [first Mask L1 Loss: 0.00024] [second Mask L1 Loss: 0.00014]
[D Loss: 0.00014] [G Loss: -0.12734] time_left: 23:40:03.591277
[Epoch 1/40] [Batch 39/1938] [first Mask L1 Loss: 0.00015] [second Mask L1 Loss: 0.00006]
[D Loss: 0.00001] [G Loss: -0.21134] time_left: 23:24:27.115826
[Epoch 1/40] [Batch 40/1938] [first Mask L1 Loss: 0.00004] [second Mask L1 Loss: 0.00006]
[D Loss: 0.00000] [G Loss: -0.11970] time_left: 23:55:39.969931
[Epoch 1/40] [Batch 41/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00013]
[D Loss: -0.00003] [G Loss: -0.08499] time_left: 22:56:47.279930
[Epoch 1/40] [Batch 42/1938] [first Mask L1 Loss: 0.00005] [second Mask L1 Loss: 0.00008]
[D Loss: -0.00002] [G Loss: -0.02769] time_left: 23:42:41.544770
[Epoch 1/40] [Batch 43/1938] [first Mask L1 Loss: 0.00008] [second Mask L1 Loss: 0.00011]
[D Loss: -0.00002] [G Loss: -0.00521] time_left: 23:40:42.333329
[Epoch 1/40] [Batch 44/1938] [first Mask L1 Loss: 0.00009] [second Mask L1 Loss: 0.00015]
[D Loss: -0.00002] [G Loss: -0.14638] time_left: 23:57:51.345390
[Epoch 1/40] [Batch 45/1938] [first Mask L1 Loss: 0.00019] [second Mask L1 Loss: 0.00008]
[D Loss: -0.00003] [G Loss: 0.08816] time_left: 23:52:28.920482
[Epoch 1/40] [Batch 46/1938] [first Mask L1 Loss: 0.00005] [second Mask L1 Loss: 0.00007]
[D Loss: 0.00001] [G Loss: -0.07732] time_left: 22:49:32.732756
[Epoch 1/40] [Batch 47/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00007]
[D Loss: -0.00006] [G Loss: -0.15195] time_left: 23:12:04.802343
[Epoch 1/40] [Batch 48/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00017]
[D Loss: -0.00006] [G Loss: -0.01650] time_left: 23:11:46.657242
[Epoch 1/40] [Batch 49/1938] [first Mask L1 Loss: 0.00012] [second Mask L1 Loss: 0.00007]
[D Loss: 0.00003] [G Loss: -0.02275] time_left: 23:27:39.452708
Traceback (most recent call last):
  File "train.py", line 78, in <module>
    trainer.WGAN_trainer(opt)
  File "/workspace/jaejun/inpainting/code/trainer.py", line 186, in WGAN_trainer
    utils.save_samples(sample_folder = sample_folder, sample_name = 'epoch%d' % (epoch + 1), img_list = img_list, name_list = name_list)
  File "/workspace/jaejun/inpainting/code/utils.py", line 135, in save_samples
    save_spectrogram(gt, sample_folder, save_img_name)
  File "/workspace/jaejun/inpainting/code/utils.py", line 184, in save_spectrogram
    im = axs.imshow(librosa.amplitude_to_db(spec), origin='lower', aspect=aspect)
NameError: name 'librosa' is not defined
[Epoch 1/40] [Batch 50/1938] [first Mask L1 Loss: 0.00006] [second Mask L1 Loss: 0.00005]
[D Loss: -0.00011] [G Loss: 0.03629] time_left: 22:56:44.499762
The trained model is successfully saved at epoch 1